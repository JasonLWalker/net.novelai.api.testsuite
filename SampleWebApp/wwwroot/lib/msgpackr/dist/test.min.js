/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/msgpackr@1.10.1/dist/test.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
!function(e,t,r,n){"use strict";var a,s,i;try{a=new TextDecoder}catch(e){}var u=0;const o=[];var l,c,f,p,d,h=o,g=0,y={},b=0,w=0,m=[],v={useRecords:!1,mapsAsObjects:!0};class k{}const S=new k;S.name="MessagePack 0xC1";var E,q,O,A=!1,x=2;try{new Function("")}catch(e){x=1/0}let U=class{constructor(e){e&&(!1===e.useRecords&&void 0===e.mapsAsObjects&&(e.mapsAsObjects=!0),e.sequential&&!1!==e.trusted&&(e.trusted=!0,e.structures||0==e.useRecords||(e.structures=[],e.maxSharedStructures||(e.maxSharedStructures=0))),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0),e.int64AsNumber&&(e.int64AsType="number")),Object.assign(this,e)}unpack(e,t){if(s)return ae((()=>(se(),this?this.unpack(e,t):U.prototype.unpack.call(v,e,t))));e.buffer||e.constructor!==ArrayBuffer||(e="undefined"!=typeof Buffer?Buffer.from(e):new Uint8Array(e)),"object"==typeof t?(i=t.end||e.length,u=t.start||0):(u=0,i=t>-1?t:e.length),g=0,w=0,c=null,h=o,f=null,s=e;try{d=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(t){if(s=null,e instanceof Uint8Array)throw t;throw new Error("Source must be a Uint8Array or Buffer but was a "+(e&&"object"==typeof e?e.constructor.name:typeof e))}if(this instanceof U){if(y=this,this.structures)return l=this.structures,_(t);(!l||l.length>0)&&(l=[])}else y=v,(!l||l.length>0)&&(l=[]);return _(t)}unpackMultiple(e,t){let r,n=0;try{A=!0;let a=e.length,s=this?this.unpack(e,a):ue.unpack(e,a);if(!t){for(r=[s];u<a;)n=u,r.push(_());return r}if(!1===t(s,n,u))return;for(;u<a;)if(n=u,!1===t(_(),n,u))return}catch(e){throw e.lastPosition=n,e.values=r,e}finally{A=!1,se()}}_mergeStructures(e,t){q&&(e=q.call(this,e)),e=e||[],Object.isFrozen(e)&&(e=e.map((e=>e.slice(0))));for(let t=0,r=e.length;t<r;t++){let r=e[t];r&&(r.isShared=!0,t>=32&&(r.highByte=t-32>>5))}e.sharedLength=e.length;for(let r in t||[])if(r>=0){let n=e[r],a=t[r];a&&(n&&((e.restoreStructures||(e.restoreStructures=[]))[r]=n),e[r]=a)}return this.structures=e}decode(e,t){return this.unpack(e,t)}};function _(e){try{if(!y.trusted&&!A){let e=l.sharedLength||0;e<l.length&&(l.length=e)}let t;if(y.randomAccessStructure&&s[u]<64&&s[u]>=32&&E?(t=E(s,u,i,y),s=null,e&&e.lazy||!t||(t=t.toJSON()),u=i):t=j(),f&&(u=f.postBundlePosition,f=null),A&&(l.restoreStructures=null),u==i)l&&l.restoreStructures&&I(),l=null,s=null,p&&(p=null);else{if(u>i)throw new Error("Unexpected end of MessagePack data");if(!A){let e;try{e=JSON.stringify(t,((e,t)=>"bigint"==typeof t?`${t}n`:t)).slice(0,100)}catch(t){e="(JSON view not available "+t+")"}throw new Error("Data read, but end of buffer not reached "+e)}}return t}catch(e){throw l&&l.restoreStructures&&I(),se(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer")||u>i)&&(e.incomplete=!0),e}}function I(){for(let e in l.restoreStructures)l[e]=l.restoreStructures[e];l.restoreStructures=null}function j(){let e=s[u++];if(e<160){if(e<128){if(e<64)return e;{let t=l[63&e]||y.getStructures&&N()[63&e];return t?(t.read||(t.read=D(t,63&e)),t.read()):e}}if(e<144){if(e-=128,y.mapsAsObjects){let t={};for(let r=0;r<e;r++){let e=H();"__proto__"===e&&(e="__proto_"),t[e]=j()}return t}{let t=new Map;for(let r=0;r<e;r++)t.set(j(),j());return t}}{e-=144;let t=new Array(e);for(let r=0;r<e;r++)t[r]=j();return y.freezeData?Object.freeze(t):t}}if(e<192){let t=e-160;if(w>=u)return c.slice(u-b,(u+=t)-b);if(0==w&&i<140){let e=t<16?Z(t):W(t);if(null!=e)return e}return C(t)}{let t;switch(e){case 192:return null;case 193:return f?(t=j(),t>0?f[1].slice(f.position1,f.position1+=t):f[0].slice(f.position0,f.position0-=t)):S;case 194:return!1;case 195:return!0;case 196:if(t=s[u++],void 0===t)throw new Error("Unexpected end of buffer");return K(t);case 197:return t=d.getUint16(u),u+=2,K(t);case 198:return t=d.getUint32(u),u+=4,K(t);case 199:return Y(s[u++]);case 200:return t=d.getUint16(u),u+=2,Y(t);case 201:return t=d.getUint32(u),u+=4,Y(t);case 202:if(t=d.getFloat32(u),y.useFloat32>2){let e=ie[(127&s[u])<<1|s[u+1]>>7];return u+=4,(e*t+(t>0?.5:-.5)>>0)/e}return u+=4,t;case 203:return t=d.getFloat64(u),u+=8,t;case 204:return s[u++];case 205:return t=d.getUint16(u),u+=2,t;case 206:return t=d.getUint32(u),u+=4,t;case 207:return"number"===y.int64AsType?(t=4294967296*d.getUint32(u),t+=d.getUint32(u+4)):"string"===y.int64AsType?t=d.getBigUint64(u).toString():"auto"===y.int64AsType?(t=d.getBigUint64(u),t<=BigInt(2)<<BigInt(52)&&(t=Number(t))):t=d.getBigUint64(u),u+=8,t;case 208:return d.getInt8(u++);case 209:return t=d.getInt16(u),u+=2,t;case 210:return t=d.getInt32(u),u+=4,t;case 211:return"number"===y.int64AsType?(t=4294967296*d.getInt32(u),t+=d.getUint32(u+4)):"string"===y.int64AsType?t=d.getBigInt64(u).toString():"auto"===y.int64AsType?(t=d.getBigInt64(u),t>=BigInt(-2)<<BigInt(52)&&t<=BigInt(2)<<BigInt(52)&&(t=Number(t))):t=d.getBigInt64(u),u+=8,t;case 212:if(t=s[u++],114==t)return X(63&s[u++]);{let e=m[t];if(e)return e.read?(u++,e.read(j())):e.noBuffer?(u++,e()):e(s.subarray(u,++u));throw new Error("Unknown extension "+t)}case 213:return t=s[u],114==t?(u++,X(63&s[u++],s[u++])):Y(2);case 214:return Y(4);case 215:return Y(8);case 216:return Y(16);case 217:return t=s[u++],w>=u?c.slice(u-b,(u+=t)-b):M(t);case 218:return t=d.getUint16(u),w>=(u+=2)?c.slice(u-b,(u+=t)-b):R(t);case 219:return t=d.getUint32(u),w>=(u+=4)?c.slice(u-b,(u+=t)-b):F(t);case 220:return t=d.getUint16(u),u+=2,z(t);case 221:return t=d.getUint32(u),u+=4,z(t);case 222:return t=d.getUint16(u),u+=2,P(t);case 223:return t=d.getUint32(u),u+=4,P(t);default:if(e>=224)return e-256;if(void 0===e){let e=new Error("Unexpected end of MessagePack data");throw e.incomplete=!0,e}throw new Error("Unknown MessagePack token "+e)}}}const B=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function D(e,t){function r(){if(r.count++>x){let r=e.read=new Function("r","return function(){return "+(y.freezeData?"Object.freeze":"")+"({"+e.map((e=>"__proto__"===e?"__proto_:r()":B.test(e)?e+":r()":"["+JSON.stringify(e)+"]:r()")).join(",")+"})}")(j);return 0===e.highByte&&(e.read=T(t,e.read)),r()}let n={};for(let t=0,r=e.length;t<r;t++){let r=e[t];"__proto__"===r&&(r="__proto_"),n[r]=j()}return y.freezeData?Object.freeze(n):n}return r.count=0,0===e.highByte?T(t,r):r}const T=(e,t)=>function(){let r=s[u++];if(0===r)return t();let n=e<32?-(e+(r<<5)):e+(r<<5),a=l[n]||N()[n];if(!a)throw new Error("Record id is not defined for "+n);return a.read||(a.read=D(a,e)),a.read()};function N(){let e=ae((()=>(s=null,y.getStructures())));return l=y._mergeStructures(e,l)}var C=V,M=V,R=V,F=V;function V(e){let t;if(e<16&&(t=Z(e)))return t;if(e>64&&a)return a.decode(s.subarray(u,u+=e));const r=u+e,n=[];for(t="";u<r;){const e=s[u++];if(0==(128&e))n.push(e);else if(192==(224&e)){const t=63&s[u++];n.push((31&e)<<6|t)}else if(224==(240&e)){const t=63&s[u++],r=63&s[u++];n.push((31&e)<<12|t<<6|r)}else if(240==(248&e)){let t=(7&e)<<18|(63&s[u++])<<12|(63&s[u++])<<6|63&s[u++];t>65535&&(t-=65536,n.push(t>>>10&1023|55296),t=56320|1023&t),n.push(t)}else n.push(e);n.length>=4096&&(t+=J.apply(String,n),n.length=0)}return n.length>0&&(t+=J.apply(String,n)),t}function L(e,t,r){let n=s;s=e,u=t;try{return V(r)}finally{s=n}}function z(e){let t=new Array(e);for(let r=0;r<e;r++)t[r]=j();return y.freezeData?Object.freeze(t):t}function P(e){if(y.mapsAsObjects){let t={};for(let r=0;r<e;r++){let e=H();"__proto__"===e&&(e="__proto_"),t[e]=j()}return t}{let t=new Map;for(let r=0;r<e;r++)t.set(j(),j());return t}}var J=String.fromCharCode;function W(e){let t=u,r=new Array(e);for(let n=0;n<e;n++){const e=s[u++];if((128&e)>0)return void(u=t);r[n]=e}return J.apply(String,r)}function Z(e){if(e<4){if(e<2){if(0===e)return"";{let e=s[u++];return(128&e)>1?void(u-=1):J(e)}}{let t=s[u++],r=s[u++];if((128&t)>0||(128&r)>0)return void(u-=2);if(e<3)return J(t,r);let n=s[u++];return(128&n)>0?void(u-=3):J(t,r,n)}}{let t=s[u++],r=s[u++],n=s[u++],a=s[u++];if((128&t)>0||(128&r)>0||(128&n)>0||(128&a)>0)return void(u-=4);if(e<6){if(4===e)return J(t,r,n,a);{let e=s[u++];return(128&e)>0?void(u-=5):J(t,r,n,a,e)}}if(e<8){let i=s[u++],o=s[u++];if((128&i)>0||(128&o)>0)return void(u-=6);if(e<7)return J(t,r,n,a,i,o);let l=s[u++];return(128&l)>0?void(u-=7):J(t,r,n,a,i,o,l)}{let i=s[u++],o=s[u++],l=s[u++],c=s[u++];if((128&i)>0||(128&o)>0||(128&l)>0||(128&c)>0)return void(u-=8);if(e<10){if(8===e)return J(t,r,n,a,i,o,l,c);{let e=s[u++];return(128&e)>0?void(u-=9):J(t,r,n,a,i,o,l,c,e)}}if(e<12){let f=s[u++],p=s[u++];if((128&f)>0||(128&p)>0)return void(u-=10);if(e<11)return J(t,r,n,a,i,o,l,c,f,p);let d=s[u++];return(128&d)>0?void(u-=11):J(t,r,n,a,i,o,l,c,f,p,d)}{let f=s[u++],p=s[u++],d=s[u++],h=s[u++];if((128&f)>0||(128&p)>0||(128&d)>0||(128&h)>0)return void(u-=12);if(e<14){if(12===e)return J(t,r,n,a,i,o,l,c,f,p,d,h);{let e=s[u++];return(128&e)>0?void(u-=13):J(t,r,n,a,i,o,l,c,f,p,d,h,e)}}{let g=s[u++],y=s[u++];if((128&g)>0||(128&y)>0)return void(u-=14);if(e<15)return J(t,r,n,a,i,o,l,c,f,p,d,h,g,y);let b=s[u++];return(128&b)>0?void(u-=15):J(t,r,n,a,i,o,l,c,f,p,d,h,g,y,b)}}}}}function G(){let e,t=s[u++];if(t<192)e=t-160;else switch(t){case 217:e=s[u++];break;case 218:e=d.getUint16(u),u+=2;break;case 219:e=d.getUint32(u),u+=4;break;default:throw new Error("Expected string")}return V(e)}function K(e){return y.copyBuffers?Uint8Array.prototype.slice.call(s,u,u+=e):s.subarray(u,u+=e)}function Y(e){let t=s[u++];if(m[t]){let r;return m[t](s.subarray(u,r=u+=e),(e=>{u=e;try{return j()}finally{u=r}}))}throw new Error("Unknown extension type "+t)}var $=new Array(4096);function H(){let e=s[u++];if(!(e>=160&&e<192))return u--,Q(j());if(e-=160,w>=u)return c.slice(u-b,(u+=e)-b);if(!(0==w&&i<180))return C(e);let t,r=4095&(e<<5^(e>1?d.getUint16(u):e>0?s[u]:0)),n=$[r],a=u,o=u+e-3,l=0;if(n&&n.bytes==e){for(;a<o;){if(t=d.getUint32(a),t!=n[l++]){a=1879048192;break}a+=4}for(o+=3;a<o;)if(t=s[a++],t!=n[l++]){a=1879048192;break}if(a===o)return u=a,n.string;o-=3,a=u}for(n=[],$[r]=n,n.bytes=e;a<o;)t=d.getUint32(a),n.push(t),a+=4;for(o+=3;a<o;)t=s[a++],n.push(t);let f=e<16?Z(e):W(e);return n.string=null!=f?f:C(e)}function Q(e){if("string"==typeof e)return e;if("number"==typeof e)return e.toString();throw new Error("Invalid property type for record",typeof e)}const X=(e,t)=>{let r=j().map(Q),n=e;void 0!==t&&(e=e<32?-((t<<5)+e):(t<<5)+e,r.highByte=t);let a=l[e];return a&&(a.isShared||A)&&((l.restoreStructures||(l.restoreStructures=[]))[e]=a),l[e]=r,r.read=D(r,n),r.read()};m[0]=()=>{},m[0].noBuffer=!0,m[66]=e=>{let t=e.length,r=BigInt(128&e[0]?e[0]-256:e[0]);for(let n=1;n<t;n++)r<<=8n,r+=BigInt(e[n]);return r};let ee={Error:Error,TypeError:TypeError,ReferenceError:ReferenceError};m[101]=()=>{let e=j();return(ee[e[0]]||Error)(e[1])},m[105]=e=>{if(!1===y.structuredClone)throw new Error("Structured clone extension is disabled");let t=d.getUint32(u-4);p||(p=new Map);let r,n=s[u];r=n>=144&&n<160||220==n||221==n?[]:{};let a={target:r};p.set(t,a);let i=j();return a.used?Object.assign(r,i):(a.target=i,i)},m[112]=e=>{if(!1===y.structuredClone)throw new Error("Structured clone extension is disabled");let t=d.getUint32(u-4),r=p.get(t);return r.used=!0,r.target},m[115]=()=>new Set(j());const te=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map((e=>e+"Array"));let re="object"==typeof globalThis?globalThis:window;m[116]=e=>{let t=e[0],r=te[t];if(!r)throw new Error("Could not find typed array for code "+t);return new re[r](Uint8Array.prototype.slice.call(e,1).buffer)},m[120]=()=>{let e=j();return new RegExp(e[0],e[1])};const ne=[];function ae(e){O&&O();let t=i,r=u,n=g,a=b,o=w,m=c,v=h,k=p,S=f,E=new Uint8Array(s.slice(0,i)),q=l,x=l.slice(0,l.length),U=y,_=A,I=e();return i=t,u=r,g=n,b=a,w=o,c=m,h=v,p=k,f=S,s=E,A=_,(l=q).splice(0,l.length,...x),y=U,d=new DataView(s.buffer,s.byteOffset,s.byteLength),I}function se(){s=null,p=null,l=null}m[98]=e=>{let t=(e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3],r=u;return u+=t-e.length,f=ne,(f=[G(),G()]).position0=0,f.position1=0,f.postBundlePosition=u,u=r,j()},m[255]=e=>4==e.length?new Date(1e3*(16777216*e[0]+(e[1]<<16)+(e[2]<<8)+e[3])):8==e.length?new Date(((e[0]<<22)+(e[1]<<14)+(e[2]<<6)+(e[3]>>2))/1e6+1e3*(4294967296*(3&e[3])+16777216*e[4]+(e[5]<<16)+(e[6]<<8)+e[7])):12==e.length?new Date(((e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3])/1e6+1e3*((128&e[4]?-281474976710656:0)+1099511627776*e[6]+4294967296*e[7]+16777216*e[8]+(e[9]<<16)+(e[10]<<8)+e[11])):new Date("invalid");const ie=new Array(147);for(let e=0;e<256;e++)ie[e]=+("1e"+Math.floor(45.15-.30103*e));var ue=new U({useRecords:!1});const oe=ue.unpack,le=ue.unpackMultiple;ue.unpack;let ce,fe,pe,de=new Float32Array(1),he=new Uint8Array(de.buffer,0,4);try{ce=new TextEncoder}catch(e){}const ge="undefined"!=typeof Buffer,ye=ge?function(e){return Buffer.allocUnsafeSlow(e)}:Uint8Array,be=ge?Buffer:Uint8Array,we=ge?4294967296:2144337920;let me,ve,ke,Se,Ee,qe=0,Oe=null;const Ae=/[\u0080-\uFFFF]/,xe=Symbol("record-id");let Ue=class extends U{constructor(e){let t,r,n,a;super(e),this.offset=0;let s=be.prototype.utf8Write?function(e,t){return me.utf8Write(e,t,4294967295)}:!(!ce||!ce.encodeInto)&&function(e,t){return ce.encodeInto(e,me.subarray(t)).written},i=this;e||(e={});let u=e&&e.sequential,o=e.structures||e.saveStructures,l=e.maxSharedStructures;if(null==l&&(l=o?32:0),l>8160)throw new Error("Maximum maxSharedStructure is 8160");e.structuredClone&&null==e.moreTypes&&(this.moreTypes=!0);let c=e.maxOwnStructures;null==c&&(c=o?32:64),this.structures||0==e.useRecords||(this.structures=[]);let f=l>32||c+l>64,p=l+64,d=l+c+64;if(d>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let h=[],g=0,y=0;this.pack=this.encode=function(e,s){if(me||(me=new ye(8192),ke=me.dataView||(me.dataView=new DataView(me.buffer,0,8192)),qe=0),Se=me.length-10,Se-qe<2048?(me=new ye(me.length),ke=me.dataView||(me.dataView=new DataView(me.buffer,0,me.length)),Se=me.length-10,qe=0):qe=qe+7&2147483640,t=qe,s&Re&&(qe+=255&s),a=i.structuredClone?new Map:null,i.bundleStrings&&"string"!=typeof e?(Oe=[],Oe.size=1/0):Oe=null,n=i.structures,n){n.uninitialized&&(n=i._mergeStructures(i.getStructures()));let e=n.sharedLength||0;if(e>l)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+n.sharedLength);if(!n.transitions){n.transitions=Object.create(null);for(let t=0;t<e;t++){let e=n[t];if(!e)continue;let r,a=n.transitions;for(let t=0,n=e.length;t<n;t++){let n=e[t];r=a[n],r||(r=a[n]=Object.create(null)),a=r}a[xe]=t+64}this.lastNamedStructuresLength=e}u||(n.nextId=e+64)}let o;r&&(r=!1);try{i.randomAccessStructure&&e&&e.constructor&&e.constructor===Object?x(e):m(e);let r=Oe;if(Oe&&Be(t,m,0),a&&a.idsToInsert){let e=a.idsToInsert.sort(((e,t)=>e.offset>t.offset?1:-1)),n=e.length,s=-1;for(;r&&n>0;){let a=e[--n].offset+t;a<r.stringsPosition+t&&-1===s&&(s=0),a>r.position+t?s>=0&&(s+=6):(s>=0&&(ke.setUint32(r.position+t,ke.getUint32(r.position+t)+s),s=-1),r=r.previous,n++)}s>=0&&r&&ke.setUint32(r.position+t,ke.getUint32(r.position+t)+s),qe+=6*e.length,qe>Se&&q(qe),i.offset=qe;let u=function(e,t){let r,n=6*t.length,a=e.length-n;for(;r=t.pop();){let t=r.offset,s=r.id;e.copyWithin(t+n,t,a),n-=6;let i=t+n;e[i++]=214,e[i++]=105,e[i++]=s>>24,e[i++]=s>>16&255,e[i++]=s>>8&255,e[i++]=255&s,a=t}return e}(me.subarray(t,qe),e);return a=null,u}return i.offset=qe,s&Ce?(me.start=t,me.end=qe,me):me.subarray(t,qe)}catch(e){throw o=e,e}finally{if(n&&(b(),r&&i.saveStructures)){let r=n.sharedLength||0,a=me.subarray(t,qe),u=De(n,i);if(!o)return!1===i.saveStructures(u,u.isCompatible)?i.pack(e,s):(i.lastNamedStructuresLength=r,a)}s&Me&&(qe=t)}};const b=()=>{y<10&&y++;let e=n.sharedLength||0;if(n.length>e&&!u&&(n.length=e),g>1e4)n.transitions=null,y=0,g=0,h.length>0&&(h=[]);else if(h.length>0&&!u){for(let e=0,t=h.length;e<t;e++)h[e][xe]=0;h=[]}},w=e=>{var t=e.length;t<16?me[qe++]=144|t:t<65536?(me[qe++]=220,me[qe++]=t>>8,me[qe++]=255&t):(me[qe++]=221,ke.setUint32(qe,t),qe+=4);for(let r=0;r<t;r++)m(e[r])},m=e=>{qe>Se&&(me=q(qe));var r,n=typeof e;if("string"===n){let n,a=e.length;if(Oe&&a>=4&&a<4096){if((Oe.size+=a)>21760){let e,r,n=(Oe[0]?3*Oe[0].length+Oe[1].length:0)+10;qe+n>Se&&(me=q(qe+n)),Oe.position?(r=Oe,me[qe]=200,qe+=3,me[qe++]=98,e=qe-t,qe+=4,Be(t,m,0),ke.setUint16(e+t-3,qe-t-e)):(me[qe++]=214,me[qe++]=98,e=qe-t,qe+=4),Oe=["",""],Oe.previous=r,Oe.size=0,Oe.position=e}let r=Ae.test(e);return Oe[r?0:1]+=e,me[qe++]=193,void m(r?-a:a)}n=a<32?1:a<256?2:a<65536?3:5;let i=3*a;if(qe+i>Se&&(me=q(qe+i)),a<64||!s){let t,s,i,u=qe+n;for(t=0;t<a;t++)s=e.charCodeAt(t),s<128?me[u++]=s:s<2048?(me[u++]=s>>6|192,me[u++]=63&s|128):55296==(64512&s)&&56320==(64512&(i=e.charCodeAt(t+1)))?(s=65536+((1023&s)<<10)+(1023&i),t++,me[u++]=s>>18|240,me[u++]=s>>12&63|128,me[u++]=s>>6&63|128,me[u++]=63&s|128):(me[u++]=s>>12|224,me[u++]=s>>6&63|128,me[u++]=63&s|128);r=u-qe-n}else r=s(e,qe+n);r<32?me[qe++]=160|r:r<256?(n<2&&me.copyWithin(qe+2,qe+1,qe+1+r),me[qe++]=217,me[qe++]=r):r<65536?(n<3&&me.copyWithin(qe+3,qe+2,qe+2+r),me[qe++]=218,me[qe++]=r>>8,me[qe++]=255&r):(n<5&&me.copyWithin(qe+5,qe+3,qe+3+r),me[qe++]=219,ke.setUint32(qe,r),qe+=4),qe+=r}else if("number"===n)if(e>>>0===e)e<32||e<128&&!1===this.useRecords||e<64&&!this.randomAccessStructure?me[qe++]=e:e<256?(me[qe++]=204,me[qe++]=e):e<65536?(me[qe++]=205,me[qe++]=e>>8,me[qe++]=255&e):(me[qe++]=206,ke.setUint32(qe,e),qe+=4);else if(e>>0===e)e>=-32?me[qe++]=256+e:e>=-128?(me[qe++]=208,me[qe++]=e+256):e>=-32768?(me[qe++]=209,ke.setInt16(qe,e),qe+=2):(me[qe++]=210,ke.setInt32(qe,e),qe+=4);else{let t;if((t=this.useFloat32)>0&&e<4294967296&&e>=-2147483648){let r;if(me[qe++]=202,ke.setFloat32(qe,e),t<4||(r=e*ie[(127&me[qe])<<1|me[qe+1]>>7])>>0===r)return void(qe+=4);qe--}me[qe++]=203,ke.setFloat64(qe,e),qe+=8}else if("object"===n||"function"===n)if(e){if(a){let r=a.get(e);if(r){if(!r.id){let e=a.idsToInsert||(a.idsToInsert=[]);r.id=e.push(r)}return me[qe++]=214,me[qe++]=112,ke.setUint32(qe,r.id),void(qe+=4)}a.set(e,{offset:qe-t})}let s=e.constructor;if(s===Object)E(e,!0);else if(s===Array)w(e);else if(s===Map)if(this.mapAsEmptyObject)me[qe++]=128;else{(r=e.size)<16?me[qe++]=128|r:r<65536?(me[qe++]=222,me[qe++]=r>>8,me[qe++]=255&r):(me[qe++]=223,ke.setUint32(qe,r),qe+=4);for(let[t,r]of e)m(t),m(r)}else{for(let t=0,r=fe.length;t<r;t++){if(e instanceof pe[t]){let r=fe[t];if(r.write){r.type&&(me[qe++]=212,me[qe++]=r.type,me[qe++]=0);let t=r.write.call(this,e);return void(t===e?Array.isArray(e)?w(e):E(e):m(t))}let n,a=me,s=ke,i=qe;me=null;try{n=r.pack.call(this,e,(e=>(me=a,a=null,qe+=e,qe>Se&&q(qe),{target:me,targetView:ke,position:qe-e})),m)}finally{a&&(me=a,ke=s,qe=i,Se=me.length-10)}return void(n&&(n.length+qe>Se&&q(n.length+qe),qe=je(n,me,qe,r.type)))}}if(Array.isArray(e))w(e);else{if(e.toJSON){const t=e.toJSON();if(t!==e)return m(t)}if("function"===n)return m(this.writeFunction&&this.writeFunction(e));E(e,!e.hasOwnProperty)}}}else me[qe++]=192;else if("boolean"===n)me[qe++]=e?195:194;else if("bigint"===n){if(e<BigInt(1)<<BigInt(63)&&e>=-(BigInt(1)<<BigInt(63)))me[qe++]=211,ke.setBigInt64(qe,e);else if(e<BigInt(1)<<BigInt(64)&&e>0)me[qe++]=207,ke.setBigUint64(qe,e);else{if(!this.largeBigIntToFloat){if(this.useBigIntExtension&&e<2n**1023n&&e>-(2n**1023n)){me[qe++]=199,qe++,me[qe++]=66;let t,r=[];do{let n=0xffn&e;t=(0x80n&n)===(e<0n?0x80n:0n),r.push(n),e>>=8n}while(0n!==e&&-1n!==e||!t);me[qe-2]=r.length;for(let e=r.length;e>0;)me[qe++]=Number(r[--e]);return}throw new RangeError(e+" was too large to fit in MessagePack 64-bit integer format, use useBigIntExtension or set largeBigIntToFloat to convert to float-64")}me[qe++]=203,ke.setFloat64(qe,Number(e))}qe+=8}else{if("undefined"!==n)throw new Error("Unknown type: "+n);this.encodeUndefinedAsNil?me[qe++]=192:(me[qe++]=212,me[qe++]=0,me[qe++]=0)}},v=this.variableMapSize||this.coercibleKeyAsNumber?e=>{let t,r=Object.keys(e),n=r.length;if(n<16?me[qe++]=128|n:n<65536?(me[qe++]=222,me[qe++]=n>>8,me[qe++]=255&n):(me[qe++]=223,ke.setUint32(qe,n),qe+=4),this.coercibleKeyAsNumber)for(let a=0;a<n;a++){t=r[a];let n=Number(t);m(isNaN(n)?t:n),m(e[t])}else for(let a=0;a<n;a++)m(t=r[a]),m(e[t])}:(e,r)=>{me[qe++]=222;let n=qe-t;qe+=2;let a=0;for(let t in e)(r||e.hasOwnProperty(t))&&(m(t),m(e[t]),a++);me[n+++t]=a>>8,me[n+t]=255&a},k=!1===this.useRecords?v:e.progressiveRecords&&!f?(e,r)=>{let a,s,i=n.transitions||(n.transitions=Object.create(null)),u=qe++-t;for(let o in e)if(r||e.hasOwnProperty(o)){if(a=i[o],a)i=a;else{let r=Object.keys(e),l=i;i=n.transitions;let c=0;for(let e=0,t=r.length;e<t;e++){let t=r[e];a=i[t],a||(a=i[t]=Object.create(null),c++),i=a}u+t+1==qe?(qe--,O(i,r,c)):A(i,r,u,c),s=!0,i=l[o]}m(e[o])}if(!s){let r=i[xe];r?me[u+t]=r:A(i,Object.keys(e),u,0)}}:(e,t)=>{let r,a=n.transitions||(n.transitions=Object.create(null)),s=0;for(let n in e)(t||e.hasOwnProperty(n))&&(r=a[n],r||(r=a[n]=Object.create(null),s++),a=r);let i=a[xe];i?i>=96&&f?(me[qe++]=96+(31&(i-=96)),me[qe++]=i>>5):me[qe++]=i:O(a,a.__keys__||Object.keys(e),s);for(let r in e)(t||e.hasOwnProperty(r))&&m(e[r])},S="function"==typeof this.useRecords&&this.useRecords,E=S?(e,t)=>{S(e)?k(e,t):v(e,t)}:k,q=e=>{let r;if(e>16777216){if(e-t>we)throw new Error("Packed buffer would be larger than maximum buffer size");r=Math.min(we,4096*Math.round(Math.max((e-t)*(e>67108864?1.25:2),4194304)/4096))}else r=1+(Math.max(e-t<<2,me.length-1)>>12)<<12;let n=new ye(r);return ke=n.dataView||(n.dataView=new DataView(n.buffer,0,r)),e=Math.min(e,me.length),me.copy?me.copy(n,0,t,e):n.set(me.slice(t,e)),qe-=t,t=0,Se=n.length-10,me=n},O=(e,t,a)=>{let s=n.nextId;s||(s=64),s<p&&this.shouldShareStructure&&!this.shouldShareStructure(t)?(s=n.nextOwnId,s<d||(s=p),n.nextOwnId=s+1):(s>=d&&(s=p),n.nextId=s+1);let i=t.highByte=s>=96&&f?s-96>>5:-1;e[xe]=s,e.__keys__=t,n[s-64]=t,s<p?(t.isShared=!0,n.sharedLength=s-63,r=!0,i>=0?(me[qe++]=96+(31&s),me[qe++]=i):me[qe++]=s):(i>=0?(me[qe++]=213,me[qe++]=114,me[qe++]=96+(31&s),me[qe++]=i):(me[qe++]=212,me[qe++]=114,me[qe++]=s),a&&(g+=y*a),h.length>=c&&(h.shift()[xe]=0),h.push(e),m(t))},A=(e,r,n,a)=>{let s=me,i=qe,u=Se,o=t;me=ve,qe=0,t=0,me||(ve=me=new ye(8192)),Se=me.length-10,O(e,r,a),ve=me;let l=qe;if(me=s,qe=i,Se=u,t=o,l>1){let e=qe+l-1;e>Se&&q(e);let r=n+t;me.copyWithin(r+l,r+1,qe),me.set(ve.slice(0,l),r),qe=e}else me[n+t]=ve[0]},x=(e,a)=>{let s=Ee(e,me,t,qe,n,q,((e,t,n)=>{if(n)return r=!0;qe=t;let a=me;return m(e),b(),a!==me?{position:qe,targetView:ke,target:me}:qe}),this);if(0===s)return E(e,!0);qe=s}}useBuffer(e){me=e,ke=new DataView(me.buffer,me.byteOffset,me.byteLength),qe=0}clearSharedData(){this.structures&&(this.structures=[]),this.typedStructs&&(this.typedStructs=[])}};function _e(e,t,r,n){let a=e.byteLength;if(a+1<256){var{target:s,position:i}=r(4+a);s[i++]=199,s[i++]=a+1}else if(a+1<65536){var{target:s,position:i}=r(5+a);s[i++]=200,s[i++]=a+1>>8,s[i++]=a+1&255}else{var{target:s,position:i,targetView:u}=r(7+a);s[i++]=201,u.setUint32(i,a+1),i+=4}s[i++]=116,s[i++]=t,s.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),i)}function Ie(e,t){let r=e.byteLength;var n,a;if(r<256){var{target:n,position:a}=t(r+2);n[a++]=196,n[a++]=r}else if(r<65536){var{target:n,position:a}=t(r+3);n[a++]=197,n[a++]=r>>8,n[a++]=255&r}else{var{target:n,position:a,targetView:s}=t(r+5);n[a++]=198,s.setUint32(a,r),a+=4}n.set(e,a)}function je(e,t,r,n){let a=e.length;switch(a){case 1:t[r++]=212;break;case 2:t[r++]=213;break;case 4:t[r++]=214;break;case 8:t[r++]=215;break;case 16:t[r++]=216;break;default:a<256?(t[r++]=199,t[r++]=a):a<65536?(t[r++]=200,t[r++]=a>>8,t[r++]=255&a):(t[r++]=201,t[r++]=a>>24,t[r++]=a>>16&255,t[r++]=a>>8&255,t[r++]=255&a)}return t[r++]=n,t.set(e,r),r+=a}function Be(e,t,r){if(Oe.length>0){ke.setUint32(Oe.position+e,qe+r-Oe.position-e),Oe.stringsPosition=qe-e;let n=Oe;Oe=null,t(n[0]),t(n[1])}}function De(e,t){return e.isCompatible=e=>{let r=!e||(t.lastNamedStructuresLength||0)===e.length;return r||t._mergeStructures(e),r},e}pe=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,k],fe=[{pack(e,t,r){let n=e.getTime()/1e3;if((this.useTimestamp32||0===e.getMilliseconds())&&n>=0&&n<4294967296){let{target:e,targetView:r,position:a}=t(6);e[a++]=214,e[a++]=255,r.setUint32(a,n)}else if(n>0&&n<4294967296){let{target:r,targetView:a,position:s}=t(10);r[s++]=215,r[s++]=255,a.setUint32(s,4e6*e.getMilliseconds()+(n/1e3/4294967296>>0)),a.setUint32(s+4,n)}else if(isNaN(n)){if(this.onInvalidDate)return t(0),r(this.onInvalidDate());let{target:e,targetView:n,position:a}=t(3);e[a++]=212,e[a++]=255,e[a++]=255}else{let{target:r,targetView:a,position:s}=t(15);r[s++]=199,r[s++]=12,r[s++]=255,a.setUint32(s,1e6*e.getMilliseconds()),a.setBigInt64(s+4,BigInt(Math.floor(n)))}}},{pack(e,t,r){if(this.setAsEmptyObject)return t(0),r({});let n=Array.from(e),{target:a,position:s}=t(this.moreTypes?3:0);this.moreTypes&&(a[s++]=212,a[s++]=115,a[s++]=0),r(n)}},{pack(e,t,r){let{target:n,position:a}=t(this.moreTypes?3:0);this.moreTypes&&(n[a++]=212,n[a++]=101,n[a++]=0),r([e.name,e.message])}},{pack(e,t,r){let{target:n,position:a}=t(this.moreTypes?3:0);this.moreTypes&&(n[a++]=212,n[a++]=120,n[a++]=0),r([e.source,e.flags])}},{pack(e,t){this.moreTypes?_e(e,16,t):Ie(ge?Buffer.from(e):new Uint8Array(e),t)}},{pack(e,t){let r=e.constructor;r!==be&&this.moreTypes?_e(e,te.indexOf(r.name),t):Ie(e,t)}},{pack(e,t){let{target:r,position:n}=t(1);r[n]=193}}];let Te=new Ue({useRecords:!1});const Ne=Te.pack;Te.pack;const Ce=512,Me=1024,Re=2048,Fe=["num","object","string","ascii"];Fe[16]="date";const Ve=[!1,!0,!0,!1,!1,!0,!0,!1];let Le,ze;try{new Function(""),Le=!0}catch(e){}const Pe="undefined"!=typeof Buffer;let Je,We;try{Je=new TextEncoder}catch(e){}const Ze=Pe?function(e,t,r){return e.utf8Write(t,r,4294967295)}:!(!Je||!Je.encodeInto)&&function(e,t,r){return Je.encodeInto(t,e.subarray(r)).written};var Ge;function Ke(e,t,r,n){let a;return(a=e.ascii8||e.num8)?(r.setInt8(t,n,!0),ze=t+1,a):(a=e.string16||e.object16)?(r.setInt16(t,n,!0),ze=t+2,a):(a=e.num32)?(r.setUint32(t,3758096640+n,!0),ze=t+4,a):(a=e.num64)?(r.setFloat64(t,NaN,!0),r.setInt8(t,n),ze=t+8,a):void(ze=t)}function Ye(e,t,r){let n=Fe[t]+(r<<3),a=e[n]||(e[n]=Object.create(null));return a.__type=t,a.__size=r,a.__parent=e,a}Ge=function e(t,r,n,a,s,i,u,o){let l=o.typedStructs||(o.typedStructs=[]),c=r.dataView,f=(l.lastStringStart||100)+a,p=r.length-10,d=a;a>p&&(c=(r=i(a)).dataView,a-=n,d-=n,f-=n,n=0,p=r.length-10);let h,g=f,y=l.transitions||(l.transitions=Object.create(null)),b=l.nextId||l.length,w=b<15?1:b<240?2:b<61440?3:b<15728640?4:0;if(0===w)return 0;a+=w;let m,v=[],k=0;for(let e in t){let s=t[e],o=y[e];switch(o||(y[e]=o={key:e,parent:y,enumerationOffset:0,ascii0:null,ascii8:null,num8:null,string16:null,object16:null,num32:null,float64:null,date64:null}),a>p&&(c=(r=i(a)).dataView,a-=n,d-=n,f-=n,g-=n,n=0,p=r.length-10),typeof s){case"number":let t=s;if(b<200||!o.num64){if(t>>0===t&&t<536870912&&t>-520093696){t<246&&t>=0&&(o.num8&&!(b>200&&o.num32)||t<32&&!o.num32)?(y=o.num8||Ye(o,0,1),r[a++]=t):(y=o.num32||Ye(o,0,4),c.setUint32(a,t,!0),a+=4);break}if(t<4294967296&&t>=-2147483648&&(c.setFloat32(a,t,!0),Ve[r[a+3]>>>5])){let e;if((e=t*ie[(127&r[a+3])<<1|r[a+2]>>7])>>0===e){y=o.num32||Ye(o,0,4),a+=4;break}}}y=o.num64||Ye(o,0,8),c.setFloat64(a,t,!0),a+=8;break;case"string":let w,S=s.length;if(h=g-f,(S<<2)+g>p&&(c=(r=i((S<<2)+g)).dataView,a-=n,d-=n,f-=n,g-=n,n=0,p=r.length-10),S>65280+h>>2){v.push(e,s,a-d);break}let E=g;if(S<64){let e,t,n;for(e=0;e<S;e++)t=s.charCodeAt(e),t<128?r[g++]=t:t<2048?(w=!0,r[g++]=t>>6|192,r[g++]=63&t|128):55296==(64512&t)&&56320==(64512&(n=s.charCodeAt(e+1)))?(w=!0,t=65536+((1023&t)<<10)+(1023&n),e++,r[g++]=t>>18|240,r[g++]=t>>12&63|128,r[g++]=t>>6&63|128,r[g++]=63&t|128):(w=!0,r[g++]=t>>12|224,r[g++]=t>>6&63|128,r[g++]=63&t|128)}else g+=Ze(r,s,g),w=g-E>S;if(h<160||h<246&&(o.ascii8||o.string8)){if(w)(y=o.string8)||(l.length>10&&(y=o.ascii8)?(y.__type=2,o.ascii8=null,o.string8=y,u(null,0,!0)):y=Ye(o,2,1));else{if(0===h&&!m){m=!0,y=o.ascii0||Ye(o,3,0);break}(y=o.ascii8)||l.length>10&&(y=o.string8)||(y=Ye(o,3,1))}r[a++]=h}else y=o.string16||Ye(o,2,2),c.setUint16(a,h,!0),a+=2;break;case"object":if(s){s.constructor===Date?(y=o.date64||Ye(o,16,8),c.setFloat64(a,s.getTime(),!0),a+=8):v.push(e,s,k);break}o=Ke(o,a,c,-10),o?(y=o,a=ze):v.push(e,s,k);break;case"boolean":y=o.num8||o.ascii8||Ye(o,0,1),r[a++]=s?249:248;break;case"undefined":o=Ke(o,a,c,-9),o?(y=o,a=ze):v.push(e,s,k);break;default:v.push(e,s,k)}k++}for(let e=0,t=v.length;e<t;){let t,s=v[e++],i=v[e++],o=v[e++],l=y[s];if(l||(y[s]=l={key:s,parent:y,enumerationOffset:o-k,ascii0:null,ascii8:null,num8:null,string16:null,object16:null,num32:null,float64:null}),i){let e;h=g-f,h<65280?(y=l.object16,y?e=2:(y=l.object32)?e=4:(y=Ye(l,1,2),e=2)):(y=l.object32||Ye(l,1,4),e=4),t=u(i,g),"object"==typeof t?(g=t.position,c=t.targetView,r=t.target,f-=n,a-=n,d-=n,n=0):g=t,2===e?(c.setUint16(a,h,!0),a+=2):(c.setUint32(a,h,!0),a+=4)}else y=l.object16||Ye(l,1,2),c.setInt16(a,null===i?-10:-9,!0),a+=2;k++}let S=y[xe];if(null==S){S=o.typedStructs.length;let e,t,r=[],n=y;for(;void 0!==(t=n.__type);){let a=n.__size;n=n.__parent,e=n.key;let s=[t,a,e];n.enumerationOffset&&s.push(n.enumerationOffset),r.push(s),n=n.parent}r.reverse(),y[xe]=S,o.typedStructs[S]=r,u(null,0,!0)}switch(w){case 1:if(S>=16)return 0;r[d]=S+32;break;case 2:if(S>=256)return 0;r[d]=56,r[d+1]=S;break;case 3:if(S>=65536)return 0;r[d]=57,c.setUint16(d+1,S,!0);break;case 4:if(S>=16777216)return 0;c.setUint32(d,58+(S<<8),!0)}if(a<f){if(f===g)return a;r.copyWithin(a,f,g),g+=a-f,l.lastStringStart=a-d}else if(a>f)return f===g?a:(l.lastStringStart=a-d,e(t,r,n,d,s,i,u,o));return g},Ee=Ge,De=function(e,t){if(t.typedStructs){let r=new Map;r.set("named",e),r.set("typed",t.typedStructs),e=r}let r=t.lastTypedStructuresLength||0;return e.isCompatible=e=>{let n=!0;return e instanceof Map?((e.get("named")||[]).length!==(t.lastNamedStructuresLength||0)&&(n=!1),(e.get("typed")||[]).length!==r&&(n=!1)):(e instanceof Array||Array.isArray(e))&&e.length!==(t.lastNamedStructuresLength||0)&&(n=!1),n||t._mergeStructures(e),n},t.lastTypedStructuresLength=t.typedStructs&&t.typedStructs.length,e};var $e=Symbol.for("source");function He(e){switch(e){case 246:return null;case 247:return;case 248:return!1;case 249:return!0}throw new Error("Unknown constant")}function Qe(e){return function(){return e(this[$e])}}!function(e,t,r){E=e,q=t,O=r}((function(e,t,r,n){let a=e[t++]-32;if(a>=24)switch(a){case 24:a=e[t++];break;case 25:a=e[t++]+(e[t++]<<8);break;case 26:a=e[t++]+(e[t++]<<8)+(e[t++]<<16);break;case 27:a=e[t++]+(e[t++]<<8)+(e[t++]<<16)+(e[t++]<<24)}let s=n.typedStructs&&n.typedStructs[a];if(!s){if(e=Uint8Array.prototype.slice.call(e,t,r),r-=t,t=0,n._mergeStructures(n.getStructures()),!n.typedStructs)throw new Error("Could not find any shared typed structures");if(n.lastTypedStructuresLength=n.typedStructs.length,s=n.typedStructs[a],!s)throw new Error("Could not find typed structure "+a)}var i=s.construct;if(!i){var u=(i=s.construct=function(){}).prototype;let e,t=[],r=0;for(let a=0,i=s.length;a<i;a++){let i=s[a],[u,o,l,c]=i;"__proto__"===l&&(l="__proto_");let f,p,d={key:l,offset:r};switch(c?t.splice(a+c,0,d):t.push(d),o){case 0:f=()=>0;break;case 1:f=(e,t)=>{let r=e.bytes[t+d.offset];return r>=246?He(r):r};break;case 2:f=(e,t)=>{let r=e.bytes,n=(r.dataView||(r.dataView=new DataView(r.buffer,r.byteOffset,r.byteLength))).getUint16(t+d.offset,!0);return n>=65280?He(255&n):n};break;case 4:f=(e,t)=>{let r=e.bytes,n=(r.dataView||(r.dataView=new DataView(r.buffer,r.byteOffset,r.byteLength))).getUint32(t+d.offset,!0);return n>=4294967040?He(255&n):n}}switch(d.getRef=f,r+=o,u){case 3:e&&!e.next&&(e.next=d),e=d,d.multiGetCount=0,p=function(e){let t=e.bytes,n=e.position,a=r+n,s=f(e,n);if("number"!=typeof s)return s;let i,u=d.next;for(;u&&(i=u.getRef(e,n),"number"!=typeof i);)i=null,u=u.next;return null==i&&(i=e.bytesEnd-a),e.srcString?e.srcString.slice(s,i):L(t,s+a,i-s)};break;case 2:case 1:e&&!e.next&&(e.next=d),e=d,p=function(e){let t=e.position,a=r+t,s=f(e,t);if("number"!=typeof s)return s;let i,o=e.bytes,l=d.next;for(;l&&(i=l.getRef(e,t),"number"!=typeof i);)i=null,l=l.next;if(null==i&&(i=e.bytesEnd-a),2===u)return o.toString("utf8",s+a,i+a);We=e;try{return n.unpack(o,{start:s+a,end:i+a})}finally{We=null}};break;case 0:switch(o){case 4:p=function(e){let t=e.bytes,r=t.dataView||(t.dataView=new DataView(t.buffer,t.byteOffset,t.byteLength)),n=e.position+d.offset,a=r.getInt32(n,!0);if(a<536870912){if(a>-520093696)return a;if(a>-536870912)return He(255&a)}let s=r.getFloat32(n,!0),i=ie[(127&t[n+3])<<1|t[n+2]>>7];return(i*s+(s>0?.5:-.5)>>0)/i};break;case 8:p=function(e){let t=e.bytes,r=(t.dataView||(t.dataView=new DataView(t.buffer,t.byteOffset,t.byteLength))).getFloat64(e.position+d.offset,!0);if(isNaN(r)){let r=t[e.position+d.offset];if(r>=246)return He(r)}return r};break;case 1:p=function(e){let t=e.bytes[e.position+d.offset];return t<246?t:He(t)}}break;case 16:p=function(e){let t=e.bytes,r=t.dataView||(t.dataView=new DataView(t.buffer,t.byteOffset,t.byteLength));return new Date(r.getFloat64(e.position+d.offset,!0))}}d.get=p}if(Le){let e,r=[],a=[],s=0;for(let i of t){if(n.alwaysLazyProperty&&n.alwaysLazyProperty(i.key)){e=!0;continue}Object.defineProperty(u,i.key,{get:Qe(i.get),enumerable:!0});let t="v"+s++;a.push(t),r.push("["+JSON.stringify(i.key)+"]:"+t+"(s)")}e&&r.push("__proto__:this");let i=new Function(...a,"return function(s){return{"+r.join(",")+"}}").apply(null,t.map((e=>e.get)));Object.defineProperty(u,"toJSON",{value(e){return i.call(this,this[$e])}})}else Object.defineProperty(u,"toJSON",{value(e){let r={};for(let e=0,n=t.length;e<n;e++){let n=t[e].key;r[n]=this[n]}return r}})}var o=new i;return o[$e]={bytes:e,position:t,srcString:"",bytesEnd:r},o}),(function(e){if(!(e instanceof Map))return e;let t=e.get("typed")||[];Object.isFrozen(t)&&(t=t.map((e=>e.slice(0))));let r=e.get("named"),n=Object.create(null);for(let e=0,r=t.length;e<r;e++){let r=t[e],a=n;for(let[e,t,n]of r){let r=a[n];r||(a[n]=r={key:n,parent:a,enumerationOffset:0,ascii0:null,ascii8:null,num8:null,string16:null,object16:null,num32:null,float64:null,date64:null}),a=Ye(r,e,t)}a[xe]=e}return t.transitions=n,this.typedStructs=t,this.lastTypedStructuresLength=t.length,r}),(function(){We&&(We.bytes=Uint8Array.prototype.slice.call(We.bytes,We.position,We.bytesEnd),We.position=0,We.bytesEnd=We.bytes.length)}));if(!(void 0!==process.env.MSGPACKR_NATIVE_ACCELERATION_DISABLED&&"true"===process.env.MSGPACKR_NATIVE_ACCELERATION_DISABLED.toLowerCase())){let e;try{e="function"==typeof require?require("msgpackr-extract"):r.createRequire(document.currentScript&&document.currentScript.src||new URL("test.js",document.baseURI).href)("msgpackr-extract"),e&&function(e){function t(t){return function(r){let n=h[g++];if(null==n){if(f)return V(r);let a=s.byteOffset,l=e(u-t+a,i+a,s.buffer);if("string"==typeof l)n=l,h=o;else if(g=1,w=1,n=(h=l)[0],void 0===n)throw new Error("Unexpected end of buffer")}let a=n.length;return a<=r?(u+=r,n):(c=n,b=u,w=u+a,u+=r,n.slice(0,r))}}C=t(1),M=t(2),R=t(3),F=t(5)}(e.extractStrings)}catch(e){}}let Xe=[];for(let e=1;e<6;e++)Xe.push(JSON.parse(n.readFileSync(new URL(`./example${e>1?e:""}.json`,document.currentScript&&document.currentScript.src||new URL("test.js",document.baseURI).href))));Xe.push({name:"some other types",date:new Date,empty:""});const et=Xe[3];let tt=0;function rt(){tt++;let e=15485863*tt;return e*e*e%2038074743/2038074743}var nt=e.assert,at=Ue,st=U,it=oe,ut=le,ot=function(e){de[0]=e;let t=ie[(127&he[3])<<1|he[2]>>7];return(t*e+(e>0?.5:-.5)>>0)/t},lt=Ne,ct=function(e){if(e.Class){if(!e.pack&&!e.write)throw new Error("Extension has no pack or write function");if(e.pack&&!e.type)throw new Error("Extension has no type (numeric code to identify the extension)");pe.unshift(e.Class),fe.unshift(e)}!function(e){e.unpack?m[e.type]=e.unpack:m[e.type]=e}(e)},ft=function(e){try{return require(e)}catch(e){return{}}}("zlib");ft.deflateSync,ft.inflateSync,ft.brotliCompressSync,ft.brotliDecompressSync,ft.constants;var pt=4e3;class dt extends Array{}class ht extends Array{}class gt extends Array{}class yt{}suite("msgpackr basic tests",(function(){test("pack/unpack data",(function(){var e={data:[{a:1,name:"one",type:"odd",isOdd:!0},{a:2,name:"two",type:"even"},{a:3,name:"three",type:"odd",isOdd:!0},{a:4,name:"four",type:"even"},{a:5,name:"five",type:"odd",isOdd:!0},{a:6,name:"six",type:"even",isOdd:null}],description:"some names",types:["odd","even"],convertEnumToNum:[{prop:"test"},{prop:"test"},{prop:"test"},{prop:1},{prop:2},{prop:[void 0]},{prop:null}]};let t=new at({structures:[]});var r=t.pack(e);t.pack(e),r=t.pack(e);var n=t.unpack(r);nt.deepEqual(n,e)})),test("mixed structures",(function(){let e={a:1,b:2,c:3},t={a:1,b:2,d:4},r={a:1,b:2,e:5},n=new at({structures:[]});var a=n.pack(e),s=n.unpack(a);nt.deepEqual(s,e);a=n.pack(t),s=n.unpack(a);nt.deepEqual(s,t);a=n.pack(r),s=n.unpack(a);nt.deepEqual(s,r)})),test("mixed array",(function(){var e=["one","two","one",10,11,null,!0,"three","three","one",[3,-5,-50,-400,1.3,-5.3,!0]];let t=new at({structures:[]});var r=t.pack(e),n=t.unpack(r);nt.deepEqual(n,e)})),test("255 chars",(function(){const e="RRZG9A6I7xupPeOZhxcOcioFsuhszGOdyDUcbRf4Zef2kdPIfC9RaLO4jTM5JhuZvTsF09fbRHMGtqk7YAgu3vespeTe9l61ziZ6VrMnYu2CamK96wCkmz0VUXyqaiUoTPgzk414LS9yYrd5uh7w18ksJF5SlC2e91rukWvNqAZJjYN3jpkqHNOFchCwFrhbxq2Lrv1kSJPYCx9blRg2hGmYqTbElLTZHv20iNqwZeQbRMgSBPT6vnbCBPnOh1W";var t=lt(e),r=it(t);nt.equal(r,e)})),test("use ArrayBuffer",(function(){const e={prop:"a test"};var t=lt(e);let r=new ArrayBuffer(t.length);new Uint8Array(r).set(t);var n=it(r);nt.deepEqual(n,e)})),test("pack/unpack varying data with random access structures",(function(){let e=new at({structures:[],useRecords:!0,randomAccessStructure:!0,freezeData:!0,saveStructures(e){},getStructures(){console.log("getStructures")}});for(let n=0;n<2e3;n++){let a={},s=["foo","bar","a","b","c","name","age","d"];function i(){let e="";for(;rt()<.9;)e+=rt()<.8?"hello world":String.fromCharCode(300);return e}for(let u=0;u<20*rt();u++)a[s[Math.floor(8*rt())]]=rt()<.3?Math.floor(400*rt())/2:rt()<.3?i():rt()<.3||(rt()<.3?et:null);var t=e.pack(a),r=e.unpack(t);for(let o in r)r[o];nt.deepEqual(r,a)}}));for(let e of Xe){let t=JSON.stringify(e).slice(0,20)+"...";test("pack/unpack sample data "+t,(function(){var t=e,r=lt(t),n=it(r);nt.deepEqual(n,t);r=lt(t),n=it(r);nt.deepEqual(n,t)})),test("pack/unpack sample data with Uint8Array encoding"+t,(function(){var t=e,r=lt(t);r=new Uint8Array(r);var n=it(r);nt.deepEqual(n,t);r=lt(t),n=it(r);nt.deepEqual(n,t)})),test("pack/unpack sample data with random access structures "+t,(function(){var t=e;let r=new at({structures:[],useRecords:!0,randomAccessStructure:!0,freezeData:!0,saveStructures(e){},getStructures(){console.log("getStructures")}});for(let e=0;e<20;e++){var n=r.pack(t),a=r.unpack(n,{lazy:!0}),s={};for(let e in a)s[e]=a[e];nt.deepEqual(s,t)}})),test("pack/unpack sample data with bundled strings "+t,(function(){var t=e;let r=new at({useRecords:!1,bundleStrings:!0});var n=r.pack(t),a=r.unpack(n);nt.deepEqual(a,t)}))}test("pack/unpack sample data with useRecords function",(function(){var e=[{id:1,type:1,labels:{a:1,b:2}},{id:2,type:1,labels:{b:1,c:2}},{id:3,type:1,labels:{d:1,e:2}}];for(let n of[{useRecords:!1},{useRecords:!0},{mapsAsObjects:!0,useRecords:e=>!!e.id},{mapsAsObjects:!0,variableMapSize:!0,useRecords:e=>!!e.id}]){let a=new at(n);var t=a.pack(e),r=a.unpack(t);nt.deepEqual(r,e)}})),test("mapAsEmptyObject combination",(function(){const e=new at({useRecords:!1,encodeUndefinedAsNil:!0,variableMapSize:!0,mapAsEmptyObject:!0,setAsEmptyObject:!0}),t=new Map;t.set("a",1),t.set("b",2);const r=new Set;r.add("a"),r.add("b");const n={map:t,set:r},a=e.pack(n),s=e.unpack(a);nt.deepEqual(s.map,{}),nt.deepEqual(s.set,{})})),test("pack/unpack numeric coercible keys",(function(){var e={a:1,2:"test","-3.45":"test2"};let t=new at({variableMapSize:!0,coercibleKeyAsNumber:!0,useRecords:!1});var r=t.pack(e),n=t.unpack(r);nt.deepEqual(n,e)})),test("pack/unpack empty data with bundled strings",(function(){var e={};let t=new at({bundleStrings:!0});var r=t.pack(e),n=t.unpack(r);nt.deepEqual(n,e)})),test("pack/unpack large amount of chinese characters",(function(){const e={bundleStrings:!0},t={message:"你好你好你好你好你好你好你好你好你好"};function r(r){const n=[];for(let e=0;e<r;e++)n.push({...t});const a=new at(e),s=new st(e),i=a.pack(n),u=s.unpack(i);nt.deepEqual(n,u)}r(100),r(1e3),r(1e4)})),test("pack/unpack sequential data",(function(){var e={foo:1,bar:2};let t=new at({sequential:!0}),r=new st({sequential:!0});var n=t.pack(e),a=r.unpack(n);nt.deepEqual(a,e);n=t.pack(e),a=r.unpack(n);nt.deepEqual(a,e)})),test("pack/unpack with bundled strings and sequential",(function(){const e={bundleStrings:!0,sequential:!0},t=new at(e),r={data:42};new at(e).unpackMultiple(Buffer.concat([t.pack(r),t.pack(r)]))})),"undefined"!=typeof Buffer&&test("replace data",(function(){var e={data:[{a:1,name:"one",type:"odd",isOdd:!0,a:"13 characters"},{a:2,name:"two",type:"even",a:"11 characte"},{a:3,name:"three",type:"odd",isOdd:!0,a:"12 character"},{a:4,name:"four",type:"even",a:"9 charact"},{a:5,name:"five",type:"odd",isOdd:!0,a:"14 characters!"},{a:6,name:"six",type:"even",isOdd:null}]},t={data:[{foo:7,name:"one",type:"odd",isOdd:!0},{foo:8,name:"two",type:"even"},{foo:9,name:"three",type:"odd",isOdd:!0},{foo:10,name:"four",type:"even"},{foo:11,name:"five",type:"odd",isOdd:!0},{foo:12,name:"six",type:"even",isOdd:null}]},r=lt(e),n=lt(t),a=Buffer.alloc(8e3);r.copy(a);var s=it(a,r.length);n.copy(a);var i=it(a,n.length);nt.deepEqual(s,e),nt.deepEqual(i,t)})),test("compact 123",(function(){nt.equal(lt(123).length,1)})),test("BigInt",(function(){let e=new at({useBigIntExtension:!0}),t={a:3333333333333333333333333333n,b:1234567890123456789012345678901234567890n,c:-3333333333333333333333333333n,d:-352523523642364364364264264264264264262642642n,e:0xffffffffffffffffffffffffffn,f:-0xffffffffffffffffffffffffffn},r=e.pack(t),n=e.unpack(r);nt.deepEqual(t,n)})),test("extended class pack/unpack",(function(){function e(){}e.prototype.getDouble=function(){return 2*this.value};var t=new e;t.value=4,t.string="decode this: ᾜ";var r={prop1:"has multi-byte: ᾜ",extendedInstance:t,prop2:"more string",num:3};let n=new at;ct({Class:e,type:11,unpack:function(t){let r=new e,a=n.unpack(t);return r.value=a[0],r.string=a[1],r},pack:function(e){return n.pack([e.value,e.string])}});var a=lt(r),s=it(a);nt.deepEqual(r,s),nt.equal(s.extendedInstance.getDouble(),8)})),test("extended Array class read/write",(function(){var e=new dt;e.push(0),e.push(1),e.push(2);var t={prop1:"has multi-byte: ᾜ",extendedInstance:e,prop2:"more string",num:3};new at,ct({Class:dt,type:12,read:function(e){return Object.setPrototypeOf(e,dt.prototype),e},write:function(e){return[...e]}});var r=lt(t),n=it(r);nt.strictEqual(Object.getPrototypeOf(n.extendedInstance),dt.prototype),nt.deepEqual(t,n)})),test("unregistered extended Array class read/write",(function(){var e=new ht;e.push(0),e.push(1),e.push(2);var t={prop1:"has multi-byte: ᾜ",extendedInstance:e,prop2:"more string",num:3};new at;var r=lt(t),n=it(r);nt.strictEqual(Object.getPrototypeOf(n.extendedInstance),Array.prototype),nt.deepEqual(t,n)})),test("unregistered extended Object class read/write",(function(){var e=new yt;e.test1="string",e.test2=3421321;var t={prop1:"has multi-byte: ᾜ",extendedInstance:e,prop2:"more string",num:3};new at;var r=lt(t),n=it(r);nt.strictEqual(Object.getPrototypeOf(n.extendedInstance),Object.prototype),nt.deepEqual(t,n)})),test("extended class pack/unpack custom size",(function(){function e(){}ct({Class:e,type:1,pack:()=>"undefined"!=typeof Buffer?Buffer.alloc(256):new Uint8Array(256),unpack:e=>e.length});let t=it(lt(new e));nt.equal(t,256)})),test("extended class read/write",(function(){function e(){}e.prototype.getDouble=function(){return 2*this.value};var t=new e;t.value=4,t.string="decode this: ᾜ";var r={prop1:"has multi-byte: ᾜ",extendedInstance:t,prop2:"more string",num:3};new at,ct({Class:e,type:12,read:function(t){let r=new e;return r.value=t[0],r.string=t[1],r},write:function(e){return[e.value,e.string]}});var n=lt(r),a=it(n);nt.deepEqual(r,a),nt.equal(a.extendedInstance.getDouble(),8)})),test("extended class return self",(function(){function e(){}e.prototype.getDouble=function(){return 2*this.value};var t=new e;t.value=4,t.string="decode this: ᾜ";var r={prop1:"has multi-byte: ᾜ",extendedInstance:t,prop2:"more string",num:3};new at,ct({Class:e,type:13,read:function(t){return Object.setPrototypeOf(t,e.prototype),t},write:function(e){return e}});var n=lt(r),a=it(n);nt.deepEqual(r,a),nt.strictEqual(Object.getPrototypeOf(a.extendedInstance),e.prototype),nt.equal(a.extendedInstance.getDouble(),8)})),test("extended Array class return self",(function(){var e=new gt;e.push(0),e.push("has multi-byte: ᾜ");var t={prop1:"has multi-byte: ᾜ",extendedInstance:e,prop2:"more string",num:3};new at,ct({Class:gt,type:14,read:function(e){return Object.setPrototypeOf(e,gt.prototype),e},write:function(e){return e}});var r=lt(t),n=it(r);nt.deepEqual(t,n),nt.strictEqual(Object.getPrototypeOf(n.extendedInstance),gt.prototype),nt.equal(n.extendedInstance[0],0)})),test("extended class pack/unpack proxied",(function(){function e(){}e.prototype.__call__=function(){return 4*this.value},e.prototype.getDouble=function(){return 2*this.value};var t=function(){t.__call__()};Object.setPrototypeOf(t,e.prototype),t.value=4;var r=t;let n=new at;ct({Class:e,type:15,unpack:function(t){var r=function(){r.__call__()};return Object.setPrototypeOf(r,e.prototype),r.value=n.unpack(t),r},pack:function(e){return n.pack(e.value)}});var a=lt(r),s=it(a);nt.equal(s.getDouble(),8)})),test.skip("convert Date to string",(function(){var e={aDate:new Date};new at,ct({Class:Date,write:e=>e.toString()});var t=lt(e),r=it(t);nt.equal(r.aDate,e.aDate.toString())})),test("standard pack fails on circular reference with shared structures",(function(){var e={};e.self=e;let t=new at({structures:[],saveStructures(e){}});nt.throws((function(){t.pack(e)}))})),test("proto handling",(function(){var e=JSON.parse('{"__proto__":{"foo":3}}'),t=it(lt(e));nt(!t.foo);var r=[e,e,e,e,e,e];let n=new at;t=n.unpack(n.pack(r));for(let e of t)nt(!t.foo)})),test.skip("text decoder",(function(){let e=new TextDecoder("ISO-8859-15"),t=Buffer.alloc(3);for(var r=0;r<256;r++){t[0]=r,t[1]=0,t[2]=0;let n=e.decode(t);require("msgpackr-extract").isOneByte(n)||console.log(r.toString(16),n.length)}})),test("structured cloning: self reference",(function(){let e={test:"string",children:[{name:"child"}]};e.self=e,e.children[1]=e,e.children[2]=e.children[0],e.childrenAgain=e.children;let t=new at({moreTypes:!0,structuredClone:!0});var r=t.pack(e),n=t.unpack(r);nt.equal(n.self,n),nt.equal(n.children[0].name,"child"),nt.equal(n.children[1],n),nt.equal(n.children[0],n.children[2]),nt.equal(n.children,n.childrenAgain)})),test("structured cloning: types",(function(){let e="undefined"!=typeof Buffer?Buffer.alloc(20):new Uint8Array(20),t=new Float32Array(e.buffer,8,2);t[0]=2.25,t[1]=6;let r={error:new Error("test"),set:new Set(["a","b"]),regexp:/test/gi,float32Array:t,uint16Array:new Uint16Array([3,4])},n=new at({moreTypes:!0,structuredClone:!0});var a=n.pack(r),s=n.unpack(a);nt.deepEqual(Array.from(s.set),Array.from(r.set)),nt.equal(s.error.message,r.error.message),nt.equal(s.regexp.test("TEST"),!0),nt.equal(s.float32Array.constructor.name,"Float32Array"),nt.equal(s.float32Array[0],2.25),nt.equal(s.float32Array[1],6),nt.equal(s.uint16Array.constructor.name,"Uint16Array"),nt.equal(s.uint16Array[0],3),nt.equal(s.uint16Array[1],4)})),test("big bundledStrings",(function(){const e={bundleStrings:!0},t=new at(e),r=new st(e),n={output:[{url:"https://www.example.com/"}]};for(let e=0;e<1e4;e++)n.output.push(n.output[0]);let a=r.unpack(t.pack(n));nt.equal(a.output[0].url,n.output[0].url)})),test("structured clone with bundled strings",(function(){const e=new at({structuredClone:!0,bundleStrings:!0}),t={};let r={name1:t,name2:t},n=e.unpack(e.pack(r));nt.equal(n.name1,n.name2),r={},r.aaaa=r,n=e.unpack(e.pack(r)),nt.equal(n.aaaa,n)})),test("object without prototype",(function(){var e=Object.create(null);e.test=3;var t=lt(e),r=it(t);nt.deepEqual(r,e)})),test("separate instances",(function(){const e=new at({structures:[["m","e"],["action","share"]]}),t=new at({structures:[["m","e"],["action","share"]]});let r=e.pack([{m:1,e:2},{action:3,share:4}]);console.log(t.unpack(r))})),test("many shared structures",(function(){let e=[];for(let t=0;t<200;t++)e.push({["a"+t]:t});let t,r=[],n=new at({structures:r,saveStructures(e){t=e}});var a=n.pack(e);nt.equal(t.length,32);var s=n.unpack(a);nt.deepEqual(s,e),r=r.slice(0,32),n=new at({structures:r,maxSharedStructures:100,saveStructures(e){t=e}}),s=n.unpack(a),nt.deepEqual(s,e),r=r.slice(0,32),n=new at({structures:r,maxSharedStructures:100,saveStructures(e){t=e}});let i=n.pack(e);nt.equal(t.length,100),s=n.unpack(i),nt.deepEqual(s,e),s=n.unpack(a),nt.deepEqual(s,e),nt.equal(t.length,100),s=n.unpack(i),nt.deepEqual(s,e),nt.equal(n.structures.sharedLength,100)})),test("more shared structures",(function(){const e=[];for(let t=0;t<40;t++)e.push(["a"+t]);const t=[...e],r=new at({getStructures:()=>e,saveStructures(e){},maxSharedStructures:100}),n=new at({getStructures:()=>t,saveStructures(e){},maxSharedStructures:100}),a={a35:35},s=r.pack(a),i=n.decode(s);nt.deepEqual(a,i)})),test("big buffer",(function(){var e=1e8,t=new Uint8Array(e).fill(1),r=lt(t),n=it(r);nt.equal(n.length,e)})),test("random strings",(function(){for(var e=[],t=0;t<2e3;t++){for(var r="test";Math.random()<.7&&r.length<1048576;)r=r+String.fromCharCode(90/(Math.random()+.01))+r;e.push(r)}var n=lt(e),a=it(n);nt.deepEqual(a,e)})),test("map/date",(function(){var e=new Map;e.set(4,"four"),e.set("three",3);var t={map:e,date:new Date(1532219539733),farFutureDate:new Date(3532219539133),fartherFutureDate:new Date("2106-08-05T18:48:20.323Z"),ancient:new Date(-3532219539133),invalidDate:new Date("invalid")};let r=new at;var n=r.pack(t),a=r.unpack(n);nt.equal(a.map.get(4),"four"),nt.equal(a.map.get("three"),3),nt.equal(a.date.getTime(),1532219539733),nt.equal(a.farFutureDate.getTime(),3532219539133),nt.equal(a.fartherFutureDate.toISOString(),"2106-08-05T18:48:20.323Z"),nt.equal(a.ancient.getTime(),-3532219539133),nt.equal(a.invalidDate.toString(),"Invalid Date")})),test("map/date with options",(function(){var e=new Map;e.set(4,"four"),e.set("three",3);var t={map:e,date:new Date(1532219539011),invalidDate:new Date("invalid")};let r=new at({mapsAsObjects:!0,useTimestamp32:!0,onInvalidDate:()=>"Custom invalid date"});var n=r.pack(t),a=r.unpack(n);nt.equal(a.map[4],"four"),nt.equal(a.map.three,3),nt.equal(a.date.getTime(),1532219539e3),nt.equal(a.invalidDate,"Custom invalid date")})),test("key caching",(function(){var e={foo:2,bar:"test",four:4,seven:7,foz:3},t=lt(e),r=it(t);nt.deepEqual(r,e);t=lt(e),r=it(t);nt.deepEqual(r,e);t=lt(e),r=it(t);nt.deepEqual(r,e)})),test("strings",(function(){var e=[""],t=lt(e),r=it(t);nt.deepEqual(r,e);t=lt(e),r=it(t);nt.deepEqual(r,e);t=lt(e="decode this: ᾜ"),r=it(t);nt.deepEqual(r,e);t=lt(e="decode this that is longer but without any non-latin characters"),r=it(t);nt.deepEqual(r,e)})),test("decimal float32",(function(){var e={a:2.526,b:.0035235,c:352501e-17,d:3252.77};let t=new at({useFloat32:4});var r=t.pack(e);nt.equal(r.length,32);var n=t.unpack(r);nt.deepEqual(n,e)})),test("int64/uint64 should be bigints by default",(function(){let e=new at;var t=e.pack({a:325283295382932843n}),r=e.unpack(t);nt.deepEqual(r.a,325283295382932843n)})),test("bigint to float",(function(){let e=new at({int64AsType:"number"});var t=e.pack({a:325283295382932843n}),r=e.unpack(t);nt.deepEqual(r.a,0x483a36f08ab0d80)})),test("int64AsNumber compatibility",(function(){let e=new at({int64AsNumber:!0});var t=e.pack({a:325283295382932843n}),r=e.unpack(t);nt.deepEqual(r.a,0x483a36f08ab0d80)})),test("bigint to auto (float or bigint)",(function(){let e=new at({int64AsType:"auto"});var t=e.pack({a:-9007199254740993n,b:-9007199254740992n,c:0n,d:9007199254740992n,e:9007199254740993n}),r=e.unpack(t);nt.deepEqual(r.a,-9007199254740993n),nt.deepEqual(r.b,-9007199254740992),nt.deepEqual(r.c,0),nt.deepEqual(r.d,9007199254740992),nt.deepEqual(r.e,9007199254740993n)})),test("bigint to string",(function(){let e=new at({int64AsType:"string"});var t=e.pack({a:325283295382932843n}),r=e.unpack(t);nt.deepEqual(r.a,"325283295382932843")})),test("fixint should be one byte",(function(){let e=lt(123);nt.equal(e.length,1)})),test("numbers",(function(){var e={bigEncodable:48978578104322,dateEpoch:1530886513200,realBig:0x2fa1bfde428db000,decimal:32.55234,negative:-34.11,exponential:234e120,tiny:3.233e-120,zero:0,Infinity:1/0},t=lt(e),r=it(t);nt.deepEqual(r,e)})),test("bigint",(function(){var e={bigintSmall:352n,bigintSmallNegative:-333335252n,bigintBig:2n**64n-1n,bigintBigNegative:-(2n**63n),mixedWithNormal:44},t=lt(e),r=it(t);nt.deepEqual(r,e);var n={tooBig:2n**66n};nt.throws((function(){t=lt(n)}));let a=new at({largeBigIntToFloat:!0});t=a.pack(n),r=it(t),nt.isTrue(r.tooBig>2n**65n)})),test("roundFloat32",(function(){nt.equal(ot(.00333000003),.00333),nt.equal(ot(43.29999999993),43.3)})),test("buffers",(function(){var e={buffer1:new Uint8Array([2,3,4]),buffer2:new Uint8Array(lt(et))},t=lt(e),r=it(t);nt.deepEqual(r,e)})),test("notepack test",(function(){const e={foo:1,bar:[1,2,3,4,"abc","def"],foobar:{foo:!0,bar:-2147483649,foobar:{foo:new Uint8Array([1,2,3,4,5]),bar:1.5,foobar:[!0,!1,"abcdefghijkmonpqrstuvwxyz"]}}};var t=lt(e),r=it(t);it(t),r=it(t);nt.deepEqual(r,e)})),test("utf16 causing expansion",(function(){this.timeout(1e4);let e={fixstr:"ᾐᾑᾒᾓᾔᾕᾖᾗᾘᾙᾚᾛᾜᾝ",str8:"ᾐᾑᾒᾓᾔᾕᾖᾗᾘᾙᾚᾛᾜᾝᾐᾑᾒᾓᾔᾕᾖᾗᾘᾙᾚᾛᾜᾝᾐᾑᾒᾓᾔᾕᾖᾗᾘᾙᾚᾛᾜᾝᾐᾑᾒᾓᾔᾕᾖᾗᾘᾙᾚᾛᾜᾝᾐᾑᾒᾓᾔᾕᾖᾗᾘᾙᾚᾛᾜᾝᾐᾑᾒᾓᾔᾕᾖᾗᾘᾙᾚᾛᾜᾝᾐᾑᾒᾓᾔᾕᾖᾗᾘᾙᾚᾛᾜᾝᾐᾑᾒᾓᾔᾕᾖᾗᾘᾙᾚᾛᾜᾝᾐᾑᾒᾓᾔᾕᾖᾗᾘᾙᾚᾛᾜᾝᾐᾑᾒᾓᾔᾕᾖᾗᾘᾙᾚᾛᾜᾝᾐᾑᾒᾓᾔᾕᾖᾗᾘᾙᾚᾛᾜᾝᾐᾑᾒᾓᾔᾕᾖᾗᾘᾙᾚᾛᾜᾝᾐᾑᾒᾓᾔᾕᾖᾗᾘᾙᾚᾛᾜᾝᾐᾑᾒᾓᾔᾕᾖᾗᾘᾙᾚᾛᾜᾝᾐᾑᾒᾓᾔᾕᾖᾗᾘᾙᾚᾛᾜᾝᾐᾑᾒᾓᾔᾕᾖᾗᾘᾙᾚᾛᾜᾝ"};var t=lt(e),r=it(t);nt.deepEqual(r,e)})),test("unpackMultiple",(()=>{let e=ut(new Uint8Array([1,2,3,4]));nt.deepEqual(e,[1,2,3,4]),e=[],ut(new Uint8Array([1,2,3,4]),(t=>e.push(t))),nt.deepEqual(e,[1,2,3,4])})),test("unpackMultiple with positions",(()=>{let e=ut(new Uint8Array([1,2,3,4]));nt.deepEqual(e,[1,2,3,4]),e=[],ut(new Uint8Array([1,2,3,4]),((t,r,n)=>e.push([t,r,n]))),nt.deepEqual(e,[[1,0,1],[2,1,2],[3,2,3],[4,3,4]])})),test("pack toJSON returning this",(()=>{const e=lt(new class{someData=[1,2,3,4];toJSON(){return this}}),t=it(e);nt.deepStrictEqual(t,{someData:[1,2,3,4]})}))})),suite("msgpackr performance tests",(function(){test("performance JSON.parse",(function(){var e=et;this.timeout(1e4);var t=JSON.stringify(e);console.log("JSON size",t.length);for(var r=0;r<pt;r++)JSON.parse(t)})),test("performance JSON.stringify",(function(){var e=et;this.timeout(1e4);for(var t=0;t<pt;t++)JSON.stringify(e)})),test("performance unpack",(function(){var e=et;this.timeout(1e4);var t=lt(e);console.log("MessagePack size",t.length);let r=new at({structures:[],bundleStrings:!1});t=r.pack(e);console.log("msgpackr w/ record ext size",t.length);for(var n=0;n<pt;n++)r.unpack(t)})),test("performance pack",(function(){var e=et;this.timeout(1e4);let t=new at({structures:[],bundleStrings:!1}),r="undefined"!=typeof Buffer?Buffer.alloc(65536):new Uint8Array(65536);for(var n=0;n<pt;n++)t.useBuffer(r),t.pack(e)}))}))}(chai,0,module,fs);
//# sourceMappingURL=/sm/3dfc7e1e2bf4c2e90c2baa3134d732d726f4f7fb3271c75b6d754647d04b7b28.map